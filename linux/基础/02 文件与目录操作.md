### 概念

#### 相对路径与绝对路径

#### 特殊符号

- . 代表此层目录
- .. 代表上层目录
- -代表前一个工作目录
- ~代表当前用户的主文件夹, 也叫家目录

### 目录

- 更换目录:`cd 目录名`
- 显示当前所在目录: `pwd`
- 创建一个新目录 : `mkdir`
- 删除一个空目录: `rmdir`

```shell
mkdir -p /a/b/c/d # -p递归创建一个目录
mkdir -m 711 a # 创建一个目录时指定目录的权限

rmdir -p /a/b/c/d # 连同上层的空目录也一起删除掉
```

### 文件与目录的检查

命令ls可以查看文件和目录的属性

```shell
ls [-aAdfFhilnrRSt] 文件名或目录
ls [--color={never,auto,always}] 文件名或目录
ls [--full-time] 文件名或目录
-a # 显示全部的文件, 包括隐藏文件和. ..
-A # 显示全部的文件, 包括隐藏文件但是不包括.和..
-d #只列出目录本身, 而不列出目录内文件
-f # 直接列出结果, 而不排序(ls会默认按文件名排序)
-F # 根据文件目录等信息, 给予附加数据结构
-h # 将文件大小以易读方式展示
-i # 列出inode号码
-l # 详细信息
-n # 列出UID与GID而非使用者和群组的名称
-r # 将排序结果反向输出
-R # 将字目录一同展示出来
-S # 以文件大小排序,而不是文件名
-t # 按时间排序, 而不是文件名

--color=never # 不根据文件特性展示颜色
--color=always # 显示颜色
--color=auto # 让系统自行依据设置来判断是否显示颜色

--full-time # 显示完整时间
-time # 指定查看的时间atime/ctime/mtime
```

### 复制 移动 删除

cp命令用来复制文件, 除此之外还可以创建连接文件, 对比两文件新旧来更新文件, 还有复制整个目录的功能

```shell
cp [-adfilprsu] 来源文件 目标文件
cp [-adfilprsu] 来源文件 ... 目标文件夹
-a #相当于-dr --preserver=all的意思
-d #若来源文件为连接文件, 则复制链接文件属性而非文件本身
-f # force强制, 若目标文件已经存在且无法打开, 则移除后再尝试一次
-i # 若目标文件已经存在时, 在覆盖时会先询问
-l # 创建一个硬式链接, 而非复制文件本身
-p # 连同文件的属性(权限,用户, 时间)一起复制过去,而非使用默认属性, 备份常用这个参数
-r # 递归持续复制, 用于目录的复制行为
-s # 复制成为软连接, 即快捷方式
-u # 目标比源文件旧, 或者目标文件不存在时才赋值或更新

```

rm用来删除文件或目录

```
rm [-fir] 文件或目录
-f # 强制删除, 忽略不存在的文件, 不会出现警告信息
-i # 互动模式, 在删除前询问
-r # 递归删除
```

mv移动目录与文件, 或者改名

```shell
mv [-fiu] 源文件 目标文件
-f # 强制, 如果目标文件已存在不会询问直接覆盖
-i # 若目标文件已经存在, 会先询问
-u # 如果目标文件存在, 并且没有源文件新,才会更新
```

### 查看文件内容

查看文件内容的命令很多, 包括`cat, tac, nl, more, less, head,tail,od`, 下面来介绍一下这些个命令, 他们可以分成几类, 全部读出来的, 翻页展示的, 读取部分的

#### 全部读出

cat用来展示文件内容

```shell
-A # 相当于-vET的组合, 可以列出一些特殊字符而不是空白而已
-b # 列出行号, 仅针对非空白行, 空白行不显示行号
-E # 将结尾的断行字符$显示出来
-n # 打印出行号, 包括空白行
-T # 将[tab]按键以^T显示
-v #列出一些看不出来的特殊字符
```

tac是cat的反转, 他的作用也是, 他会先输出最后一行

nl的作用也是输出行号

```shell
nl [-bnw] 文件
-b # 指定出行号的方式
   # -b a不论是不是空行都列出行号; 
   # -b t如果有空行, 空的那一行不列出行号(默认)
-n # 列出行号表示的方法
   # -n ln 行号在屏幕最左边显示
   # -n rn 靠右显示, 不填充
   # -n rz 靠右显示, 填充0
-w # 设置空白处占用字符数
```

#### 翻页展示

more与less可以一页页的翻动去读取文件

more打开文件后可使用快捷键

```shell
空白键 # 向下翻一页
enter # 向下翻一行
/字符串 # 在当前内容中搜索在符串
:f # 显示出文件名和当前显示的行数
q # 离开阅读
b # 往回翻页(只对文件有用)
```

less同样是翻页阅读, 不过他支持的功能更多

```shell
空白键 # 向下翻动一页
pagedown # 向下翻动一页
pageup # 向上翻动一页
/字串 # 向下搜索字串
?字串 # 向上搜索字串
n # 重复前一个搜索
N # 反向的重复前一个搜索
g # 去到这个数据的第一行
G # 去到这个数据的最后一行
q # 离开阅读
```

#### 部分读取

head用来获取文件的前几行, tail用来获取文件的后几行

```shell
head [-n number] 文件 # -n后面接数字, 代表显示几行, 默认是10
tail [-n number] 文件 # 同上, tail还有一个-f的参数, 持续监测文件内容
```

其他的就是使用od来读取非文本文件了

```shell
od [-t type] 文件
-t # 指定类型输出
   # a 利用默认的字符来输出
   # c 使用ascii字符来输出
   # d[size] 利用10进制来输出数据, 每个整数占用size Bytes
   # f[size] 利用浮点数来输出数据, 每个数据占用size Bytes
   # o[size] 利用8进制来输出数据, 每个整数占用size Bytes
   # x[size] 利用16进制来输出数据, 每个整数占用size Bytes
```

### 修改文件时间或创建新文件

在介绍命令之前我们要先知道文件其实是有三个时间的, 分别是

- modification time(mtime): 文件内容更新时间
- status time(ctime): 属性更新时间
- access time(atime): 最后读取时间

 下面我们就来介绍touch命令

```shell
touch [-acdmt] 文件
-a # 仅修改access time
-c # 仅修改ctime, 若该文件不存在不会创建新文件
-m # 仅修改mtime
-d # 后面接想要改成的日期, 也可以使用--date=日期或时间
-t # 后面可以想要修订的时间, 而不是修改当前的日期, 时间格式为[YYYYMMDDhhmm]
```

```shell
touch -d "2 days ago" aa # 将文件的atime和mtime改成两天前
touch -t 201406150202 aa # 将文件的atime和mtime改成2014年6月15日2点2分
```

这里要注意的是不管怎么改atime都会变成改变时的时间

### 文件与目录的默认权限和隐藏权限

除了基本的r,w,x权限外, 在linux传统的**ext2/ext3/ext4**文件系统下, 我们还可以设置其他的系统隐藏属性, 这部分可以使用**chattr**来设置, 而以**lsattr**来查看, 最重要的属性就是可以设置其不可修改的特性, 即使是文件的拥有者都不能够修改

> 不过centos7中用的是xfs文件系统, 没有支持所有的chattr的参数, 仅有部分参数还支持

```shell
chattr +a 文件名 # 锁定文件
# rm: cannot remove ‘text’: Operation not permitted
chattr -a 文件名 # 解锁文件
lsattr 文件 # 查看文件隐藏权限
```

#### 默认权限

默认权限是新建一个文件和目录时的属性, 他与umask有关. 具体来说umask就是指定'目前使用者在创建文件或目录的时候的权限的默认值'

```shell
umask # 查看默认权限, 这样看到的是数字形式的,比如0022
umask -S # 以符号形式输出, 例如u=rwx,g=rx,o=rx
#数字形式展示的是缺失的权限, 并且他的第一组是特殊权限
```

在默认权限的属性上目录和文件是不一样的, 文件的x默认不存在,所以文件的最大分值是666, 0022也就是rw-r--r--.  目录的x是开放的, 最大分值为777, 0022就是rwxr-xr-x

那么如何去设置默认权限呢, 同样设置默认权限也是通过umask设置的

```shell
umask 权限值
```

#### 隐藏属性

```shell
chattr [+-=] [ASacdistu] 文件或目录
A # 当设置此权限时, 存取此文件他的存取时间atime将不会改变
S # 设置这个属性时, 当你对文件进行修改的时候会同步写入磁盘中
a # 当设置这个属性的时候这个文件将只能增加数据, 不能删改, 只有root才能设置这个属性
c # 这个属性会自动的将文件压缩, 读取的时候自动解压
d # 当dump程序被执行的时候, 拥有该权限的文件不会被备份
i # 拥有该权限的文件不能被删除, 改名, 设置链接也无法写入或新增数据
s # 当设置这个属性的文件被删除的时候,他会被完全的移除出这个硬盘空间
u # 与s相反, 被删后数据还会留在磁盘中
```

```shell
lsattr [-adR] 文件或目录
a # 将隐藏文件的属性也展示出来
d # 如果接的是目录, 只列出目录本身而不是目录内文件
R # 连同子目录的数据也一同并列出来
```

#### 特殊权限

```shell
ll -d /tmp;ll /usr/bin/passwd 
drwxrwxrwt. 8 root root 116 Aug 30 03:47 /tmp
-rwsr-xr-x. 1 root root 27832 Jun 10  2014 /usr/bin/passwd
```

之前我们说的权限只有rwx但是这里又出现了另外的两种权限t和s, 这又是什么权限呢

当s这个标志出现在文件拥有者的x权限上时, 此时就被称为Set UID简称**SUID**的特殊权限, SUID有这样的限制与功能:

1. SUID权限仅对二进制程序有效
2. 执行者对于该程序需要具有x的可执行权限
3. 本权限仅在执行该程序的过程中有效
4. 执行者将拥有该程序拥有者的权限

例如, 每个用户都可以用passwd来修改自己的密码

当s这个标志出现在群组的x时则成为Set GID, 简称**SGID**, 与SUID不同的是SGID可以针对文件或目录设置, 如果是针对文件来说,SGID有如下功能

1. SGID对二进制程序有用
2. 程序执行者对该程序来说需要具有可执行的权限
3. 执行者在执行的过程中将会获得该程序群组的支持

当一个目录设置了SGID之后,它将具有如下的功能

1. 使用者若对于此目录具有r与x的权限时, 该使用者能够进入此目录
2. 使用者在此目录中的有效群组将会变成该目录的群组
3. 用途: 若使用者在此目录下具有w的权限, 则使用者所创的新文件的群组与此目录的群组相同

除了SUID和SGID之外还有一个SBIT, 全称Sticky Bit. 这个目前只针对目录有效, 对于文件没有效果. SBIT对于目录的作用是

1. 当使用者对于此目录具有w,x权限时
2. 当使用者在该目录下创建文件或目录时, 仅有自己和root才有权利删除该文件

上面说了那么多, 那怎样设置SUID/SGID/SBIT呢? 

是这样的这三个权限也分别有着对应的分值SUID(4), SGID(2), SBIT(1), 在使用chmod修改权限是, 在原来的权限前面加上这个几个权限的分值就可以了, 

```shell
chmod 4755 filename
```

